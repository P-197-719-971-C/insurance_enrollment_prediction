# Insurance Enrollment Prediction

Predict employee insurance enrollment using Machine Learning.

<p align="center">
  <img src="https://img.shields.io/badge/Python-3.12+-blue?style=flat-square&logo=python" alt="Python">
  <img src="https://img.shields.io/badge/scikit-learn-1.8+-orange?style=flat-square" alt="scikit-learn">
  <img src="https://img.shields.io/badge/FastAPI-0.129+-blue?style=flat-square" alt="FastAPI">
  <img src="https://img.shields.io/badge/LightGBM-4.6+-yellow?style=flat-square" alt="LightGBM">
</p>

## ğŸ“Œ Overview

ML system for predicting employee insurance enrollment using three models with hyperparameter tuning via GridSearchCV.

## ğŸš€ Quick Start

```bash
# Install dependencies
uv sync

# Train model (default: logistic_regression)
uv run python main.py

# Train specific model
uv run python main.py logistic_regression
uv run python main.py random_forest
uv run python main.py lightgbm

# Run API server
uv run uvicorn api:app --reload

# Run Web UI
uv run python gradio_app.py
```

## ğŸ”Œ API Endpoints

| Endpoint | Method | Description |
|----------|--------|-------------|
| `/health` | GET | Health check |
| `/models` | GET | Available models |
| `/predict` | POST | Single prediction |
| `/predict/batch` | POST | Batch predictions (max 1000) |

## ğŸ“Š Model Performance

| Model | Accuracy | Precision | Recall | F1-Score | ROC-AUC |
|-------|----------|-----------|--------|----------|---------|
| Logistic Regression | 89.7% | 91.0% | 92.4% | 91.7% | 97.1% |
| Random Forest | 99.9% | 100% | 99.9% | 99.9% | 100% |
| LightGBM | 99.9% | 100% | 99.9% | 99.9% | 100% |

## ğŸ›  Tech Stack

- **Python** 3.12+
- **ML**: scikit-learn, LightGBM, pandas, numpy
- **API**: FastAPI, uvicorn
- **Web UI**: Gradio
- **Visualization**: matplotlib, seaborn, plotly

## ğŸ“ Project Structure

```
.
â”œâ”€â”€ main.py              # ML pipeline entry point
â”œâ”€â”€ api.py               # FastAPI application
â”œâ”€â”€ gradio_app.py        # Gradio web interface
â”œâ”€â”€ config.py            # Configuration
â”œâ”€â”€ src/                 # Source code
â”‚   â”œâ”€â”€ data_processing.py
â”‚   â”œâ”€â”€ feature_engineering.py
â”‚   â”œâ”€â”€ model.py
â”‚   â”œâ”€â”€ train.py
â”‚   â”œâ”€â”€ evaluate.py
â”‚   â””â”€â”€ predict.py
â”œâ”€â”€ models/              # Saved models (.pkl)
â”œâ”€â”€ data/                # Data directory
â””â”€â”€ results/             # Evaluation results
```

## ğŸ³ Docker Deployment

Containerized application with FastAPI server for easy deployment.

```bash
# Build Docker image
docker build -t insurance-prediction .

# Run container (API available at http://localhost:8000)
docker run -p 8000:8000 insurance-prediction
```

---

**Author**: Umrav Singh Shekhawat